---
import { intlFormat, formatISO } from "date-fns";
import Layout from "../../layouts/Layout.astro";
import Navigation from "../../header/Navigation.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
	const blogPosts = await getCollection("blog", (blogPost) => {
		return !blogPost.data.draft;
	});

	return blogPosts.map((blogPost) => {
		return {
			params: { slug: blogPost.slug },
			props: { blogPost }
		};
	});
}

const { blogPost } = Astro.props;
const { Content } = await blogPost.render();
---

<Layout title={`${blogPost.data.title} | Christian Rackerseder - Full-Stack JavaScript Engineer`}>
	<header class="border-b border-dracula-purple">
		<Navigation />
	</header>
	<time
		datetime={formatISO(blogPost.data.date, { representation: "date" })}
		class="block text-dracula-orange text-right m-4 sm:max-w-lg sm:m-auto sm:my-4 md:max-w-xl lg:max-w-2xl"
	>
		{
			intlFormat(blogPost.data.date, {
				year: "numeric",
				month: "long",
				day: "numeric"
			})
		}
	</time>
	<main class="m-4 sm:max-w-lg sm:m-auto sm:my-4 md:max-w-xl lg:max-w-2xl p-4 rounded-xl bg-dracula-dark">
		<h1 class="text-2xl font-extrabold text-dracula-cyan underline underline-offset-2 mb-8">
			{blogPost.data.title}
		</h1>
		<article
			class="prose prose-invert max-w-none prose-headings:underline prose-headings:text-dracula-cyan prose-headings:underline-offset-2 prose-a:text-dracula-green prose-a:no-underline prose-a:transition-colors hover:prose-a:text-dracula-purple"
		>
			<Content />
		</article>
	</main>
</Layout>
